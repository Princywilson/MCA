-- Create DEPT table
CREATE TABLE DEPT (
    DEPTNO INT PRIMARY KEY,
    NAME VARCHAR(50) NOT NULL
);

-- Create STAFF table
CREATE TABLE STAFF (
    STAFFNO INT PRIMARY KEY,
    NAME VARCHAR(50) NOT NULL,
    DOB DATE NOT NULL,
    GENDER CHAR(1) NOT NULL,
    DOJ DATE NOT NULL,
    DESIGNATION VARCHAR(50) NOT NULL,
    BASIC_PAY DECIMAL(10, 2) NOT NULL,
    DEPTNO INT NOT NULL,
    CONSTRAINT fk_staff_dept FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO),
    CONSTRAINT chk_gender CHECK (GENDER IN ('M', 'F'))
);

-- Create SKILL table
CREATE TABLE SKILL (
    SKILL_CODE INT PRIMARY KEY,
    DESCRIPTION VARCHAR(100) NOT NULL,
    CHARGE_OUTRATE DECIMAL(10, 2) NOT NULL
);

-- Create STAFF_SKILL table
CREATE TABLE STAFF_SKILL (
    STAFFNO INT,
    SKILL_CODE INT,
    PRIMARY KEY (STAFFNO, SKILL_CODE),
    CONSTRAINT fk_staff_skill_staff FOREIGN KEY (STAFFNO) REFERENCES STAFF(STAFFNO),
    CONSTRAINT fk_staff_skill_skill FOREIGN KEY (SKILL_CODE) REFERENCES SKILL(SKILL_CODE)
);

-- Create PROJECT table
CREATE TABLE PROJECT (
    PROJECTNO INT PRIMARY KEY,
    PNAME VARCHAR(100) NOT NULL,
    START_DATE DATE NOT NULL,
    END_DATE DATE,
    BUDGET DECIMAL(15, 2) NOT NULL,
    PROJECT_MANAGER_STAFFNO INT NOT NULL,
    CONSTRAINT fk_project_staff FOREIGN KEY (PROJECT_MANAGER_STAFFNO) REFERENCES STAFF(STAFFNO),
    CONSTRAINT chk_project_dates CHECK (END_DATE IS NULL OR END_DATE >= START_DATE)
);

-- Create WORKS table
CREATE TABLE WORKS (
    STAFFNO INT,
    PROJECTNO INT,
    DATE_WORKED_ON DATE NOT NULL,
    IN_TIME TIME NOT NULL,
    OUT_TIME TIME NOT NULL,
    PRIMARY KEY (STAFFNO, PROJECTNO, DATE_WORKED_ON),
    CONSTRAINT fk_works_staff FOREIGN KEY (STAFFNO) REFERENCES STAFF(STAFFNO),
    CONSTRAINT fk_works_project FOREIGN KEY (PROJECTNO) REFERENCES PROJECT(PROJECTNO),
    CONSTRAINT chk_work_times CHECK (OUT_TIME > IN_TIME)
);

-- Insert data into DEPT table
INSERT INTO DEPT (DEPTNO, NAME) VALUES
(1, 'IT'),
(2, 'HR'),
(3, 'Finance'),
(4, 'Marketing'),
(5, 'Operations');

-- Insert data into STAFF table
INSERT INTO STAFF (STAFFNO, NAME, DOB, GENDER, DOJ, DESIGNATION, BASIC_PAY, DEPTNO) VALUES
(101, 'John Smith', '1985-05-15', 'M', '2010-06-20', 'Senior Developer', 85000.00, 1),
(102, 'Emma Wilson', '1990-03-25', 'F', '2015-04-10', 'HR Manager', 75000.00, 2),
(103, 'Michael Brown', '1982-11-08', 'M', '2009-01-15', 'Financial Analyst', 70000.00, 3),
(104, 'Sophia Lee', '1988-07-19', 'F', '2012-09-30', 'Marketing Specialist', 65000.00, 4),
(105, 'Robert Johnson', '1980-02-28', 'M', '2008-03-05', 'Operations Manager', 90000.00, 5),
(106, 'Jennifer Davis', '1992-09-12', 'F', '2016-11-22', 'Developer', 72000.00, 1),
(107, 'David Miller', '1987-04-05', 'M', '2013-08-17', 'HR Assistant', 55000.00, 2),
(108, 'Sarah Taylor', '1986-12-10', 'F', '2011-05-08', 'Accountant', 68000.00, 3),
(109, 'James Wilson', '1991-08-22', 'M', '2017-03-14', 'Marketing Coordinator', 60000.00, 4),
(110, 'Olivia Garcia', '1984-06-30', 'F', '2010-10-25', 'Operations Analyst', 67000.00, 5);

-- Insert data into SKILL table
INSERT INTO SKILL (SKILL_CODE, DESCRIPTION, CHARGE_OUTRATE) VALUES
(201, 'Java Programming', 75.00),
(202, 'Database Design', 80.00),
(203, 'Web Development', 70.00),
(204, 'Project Management', 90.00),
(205, 'Data Analysis', 85.00),
(206, 'UI/UX Design', 65.00),
(207, 'Network Administration', 70.00),
(208, 'Cloud Computing', 95.00),
(209, 'Mobile Development', 85.00),
(210, 'Machine Learning', 100.00);

-- Insert data into STAFF_SKILL table
INSERT INTO STAFF_SKILL (STAFFNO, SKILL_CODE) VALUES
(101, 201), (101, 202), (101, 203), (101, 208),
(102, 204), (102, 205),
(103, 202), (103, 205),
(104, 206), (104, 204),
(105, 204), (105, 207),
(106, 201), (106, 203), (106, 209),
(107, 204),
(108, 202), (108, 205),
(109, 206),
(110, 204), (110, 207);

-- Insert data into PROJECT table
INSERT INTO PROJECT (PROJECTNO, PNAME, START_DATE, END_DATE, BUDGET, PROJECT_MANAGER_STAFFNO) VALUES
(301, 'ERP Implementation', '2023-01-15', '2023-12-31', 500000.00, 101),
(302, 'HR System Upgrade', '2023-03-10', '2023-09-30', 250000.00, 102),
(303, 'Financial Reporting Tool', '2023-02-20', '2023-08-15', 300000.00, 103),
(304, 'Marketing Campaign', '2023-04-05', '2023-10-20', 180000.00, 104),
(305, 'Supply Chain Optimization', '2023-01-30', '2023-11-30', 420000.00, 105),
(306, 'Mobile App Development', '2023-05-12', '2024-02-28', 350000.00, 101);

-- Insert data into WORKS table
INSERT INTO WORKS (STAFFNO, PROJECTNO, DATE_WORKED_ON, IN_TIME, OUT_TIME) VALUES
(101, 301, '2023-03-15', '09:00:00', '17:00:00'),
(101, 306, '2023-03-15', '17:30:00', '19:30:00'),
(102, 302, '2023-03-15', '08:30:00', '16:30:00'),
(103, 303, '2023-03-15', '09:00:00', '18:00:00'),
(104, 304, '2023-03-15', '09:30:00', '17:30:00'),
(105, 305, '2023-03-15', '08:00:00', '16:00:00'),
(106, 301, '2023-03-15', '09:00:00', '17:00:00'),
(106, 306, '2023-03-15', '17:30:00', '19:30:00'),
(107, 302, '2023-03-15', '08:30:00', '16:30:00'),
(108, 303, '2023-03-15', '09:00:00', '18:00:00'),
(109, 304, '2023-03-15', '09:30:00', '17:30:00'),
(110, 305, '2023-03-15', '08:00:00', '16:00:00'),
(101, 301, '2023-03-16', '09:00:00', '17:00:00'),
(102, 302, '2023-03-16', '08:30:00', '16:30:00'),
(101, 306, '2023-03-16', '17:30:00', '19:30:00'),
(101, 304, '2023-03-16', '20:00:00', '21:00:00');
